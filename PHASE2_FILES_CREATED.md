# Phase-2 Files Created ‚Äî Complete Manifest

## üì¶ Files Added

### Core Workflow Files

1. **`.github/workflows/phase2.yml`**
   - Orchestrates CI/CD for Phase-2 PRs
   - Runs lint, typecheck, test, build
   - Auto-applies labels based on file paths
   - Triggers Copilot Code Review
   - Posts Claude planning requests
   - **Size**: ~120 lines

2. **`.github/labeler.yml`**
   - Path-based auto-labeling configuration
   - Maps file patterns to PR labels (PR-3, PR-1, PR-5, Aurora Theme, BEE-SHIP)
   - **Size**: ~30 lines

### Agent Instructions & Guidelines

3. **`copilot-instructions.md`** (root)
   - Code review instructions for Copilot
   - Security, correctness, and quality priorities
   - Repo context (providers, Supabase, auth)
   - Rules for PRs and stacked PR workflow
   - **Size**: ~25 lines

4. **`COPILOT_GUARDRAILS.md`**
   - Strict constraints for autonomous agents
   - PR size limits, no secrets, testing requirements
   - Plan-before-edit requirement
   - Label and project linking rules
   - **Size**: ~10 lines

### Updated Files

5. **`.github/pull_request_template.md`** (updated)
   - Enhanced with Phase-2 integration checklist
   - Added Sensory Cortex pattern validation
   - Risk & rollback section
   - Agent handoff instructions with focus areas
   - **Changes**: Complete rewrite with Phase-2 context

6. **`.github/copilot-instructions.md`** (updated earlier)
   - Already enhanced with 785+ lines of detailed patterns
   - Includes component examples, state management, error handling
   - Animation patterns, testing strategies, TypeScript types
   - Styling conventions, performance considerations
   - Common pitfalls and security best practices

### Setup Automation Scripts

7. **`setup-phase2.sh`** (Unix/Linux/macOS)
   - One-command setup for entire Phase-2 infrastructure
   - Creates labels, project, provider structure
   - Generates kickoff branch and pushes to origin
   - Color-coded output with progress indicators
   - **Size**: ~200 lines

8. **`setup-phase2.bat`** (Windows)
   - Windows equivalent of setup-phase2.sh
   - Same functionality with Windows-native commands
   - Compatible with CMD and PowerShell
   - Error handling and status messages
   - **Size**: ~150 lines

### Documentation

9. **`PHASE2_SETUP_GUIDE.md`**
   - Comprehensive guide to Phase-2 automation
   - Explains all components and how they work together
   - Step-by-step setup instructions
   - Autonomous loop workflow diagram
   - Environment setup, troubleshooting, success metrics
   - **Size**: ~400 lines

10. **`lib/providers/README.md`** (will be created by scripts)
    - Provider system architecture documentation
    - OpenAI and GitHub Models adapter specifications
    - Configuration guide with AI_PROVIDER flag
    - Phase-2 implementation TODO checklist
    - Usage examples and error handling patterns
    - **Size**: ~120 lines (generated by script)

---

## üéØ What Each File Does

### Workflow Orchestration
- **phase2.yml**: Runs CI ‚Üí Labels ‚Üí Copilot Review ‚Üí Claude Brief
- **labeler.yml**: Maps file paths to PR scope labels

### Agent Guidance
- **copilot-instructions.md** (root): Tells Copilot how to review code
- **COPILOT_GUARDRAILS.md**: Enforces constraints on agents
- **.github/copilot-instructions.md**: Comprehensive dev patterns

### PR Management
- **pull_request_template.md**: Structured checklist for all PRs
- Ensures Phase-2 integration, risk assessment, agent handoff

### Automation
- **setup-phase2.sh/bat**: One-command full setup
- Creates labels, project, structure, kickoff branch

### Documentation
- **PHASE2_SETUP_GUIDE.md**: Complete guide to using the system
- **lib/providers/README.md**: Provider architecture specs

---

## üöÄ Execution Path

### Option 1: Automated Setup (Recommended)

**Windows**:
```cmd
setup-phase2.bat
```

**Unix/Linux/macOS**:
```bash
chmod +x setup-phase2.sh
./setup-phase2.sh
```

**What this does**:
1. ‚úÖ Creates 5 GitHub labels
2. ‚úÖ Creates Phase-2 project
3. ‚úÖ Creates `lib/providers/` directory
4. ‚úÖ Generates provider README with TODO checklist
5. ‚úÖ Creates and pushes `feat/phase2-kickoff` branch
6. ‚úÖ Outputs next steps (open PR)

### Option 2: Manual Setup

Follow the step-by-step instructions in `PHASE2_SETUP_GUIDE.md` under "Manual Setup".

### Option 3: Commit Files First, Run Script Later

```bash
# Stage all Phase-2 files
git add .github/workflows/phase2.yml
git add .github/labeler.yml
git add copilot-instructions.md
git add COPILOT_GUARDRAILS.md
git add .github/pull_request_template.md
git add setup-phase2.sh
git add setup-phase2.bat
git add PHASE2_SETUP_GUIDE.md
git add PHASE2_FILES_CREATED.md

# Commit
git commit -m "feat(phase2): add autonomous PR workflow infrastructure

- Add Phase-2 orchestrator workflow (CI + auto-label + Copilot CCR + Claude)
- Add auto-labeler config for PR-3, PR-1, PR-5, Aurora, BEE-SHIP
- Add Copilot code review instructions and guardrails
- Enhance PR template with Phase-2 integration checklist
- Add setup automation scripts (Unix + Windows)
- Add comprehensive Phase-2 setup guide

This enables autonomous PR workflows with:
- Automatic labeling based on file paths
- Copilot Code Review on every PR
- Claude implementation planning
- Stacked PR generation by scope
- Agent-driven fixes with < 400 LOC constraint

Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"

# Push
git push origin main

# Then run setup script to create labels, project, and kickoff branch
./setup-phase2.sh  # or setup-phase2.bat on Windows
```

---

## üîê Required Secrets

Before opening the kickoff PR, set these in **GitHub Settings ‚Üí Secrets ‚Üí Actions**:

| Secret | Description | Where to get it |
|--------|-------------|-----------------|
| `OPENAI_API_KEY` | OpenAI API key | https://platform.openai.com/api-keys |
| `SUPABASE_URL` | Supabase project URL | Supabase project settings |
| `SUPABASE_ANON_KEY` | Supabase anon key | Supabase project API settings |
| `SUPABASE_SERVICE_ROLE_KEY` | Supabase service role key | Supabase project API settings |
| `NETLIFY_AUTH_TOKEN` | Netlify personal access token | Netlify user settings ‚Üí Applications |
| `NETLIFY_SITE_ID` | Netlify site ID | Netlify site settings |

**Netlify Environment Variables** (set in Netlify dashboard):
- `AI_PROVIDER=openai` (or `github` for fallback)
- `OPENAI_API_KEY=sk-...` (same as GitHub secret)
- `GITHUB_TOKEN=ghp_...` (if using GitHub Models)

---

## ‚úÖ Verification Steps

After running setup script:

1. **Check labels exist**:
   ```bash
   gh label list | grep -E "PR-3|PR-1|PR-5|Aurora|BEE-SHIP"
   ```

2. **Check project exists**:
   ```bash
   gh project list | grep "Phase-2"
   ```

3. **Check branch was created**:
   ```bash
   git branch -r | grep phase2-kickoff
   ```

4. **Check provider README exists**:
   ```bash
   cat lib/providers/README.md
   ```

5. **Open PR and verify workflow runs**:
   - Go to GitHub repo ‚Üí Pull requests
   - Click "New pull request"
   - Base: `main`, Compare: `feat/phase2-kickoff`
   - Create pull request
   - Check Actions tab for "Phase 2 ‚Äî Providers ‚Ä¢ Supabase ‚Ä¢ Auth" workflow

---

## üé¨ What Happens Next

### Immediately after opening PR:
1. **CI Job** runs: lint ‚Üí typecheck ‚Üí test ‚Üí build
2. **Label Job** applies `PR-3: Providers` label
3. **Copilot Review Job** posts comment requesting code review
4. **Claude Brief Job** posts comment asking for implementation plans

### Within 1-2 minutes:
5. **Copilot** analyzes the PR and posts review findings
6. **Claude** posts structured implementation plans for PR-3, PR-1, PR-5

### Within 5-10 minutes (if issues found):
7. **Agents** open stacked PRs with fixes:
   - `[stack] PR-3: Implement OpenAI streaming adapter`
   - `[stack] PR-3: Add GitHub Models fallback logic`
   - `[stack] PR-1: Create Supabase RPC views for dashboard`
   - `[stack] PR-5: Enforce RLS on all API routes`

### Ongoing:
8. **Developers** review automated PRs
9. **Agents** respond to feedback and iterate
10. **PRs** are merged when approved
11. **BEE-SHIP** deploys changes to Netlify

---

## üìä Expected Outcomes

### Short-term (first PR):
- ‚úÖ Workflow runs successfully
- ‚úÖ Labels applied automatically
- ‚úÖ Copilot and Claude post comments
- ‚úÖ Agents understand the codebase context

### Medium-term (first week):
- ‚úÖ Agents open 3-5 stacked PRs
- ‚úÖ Each PR < 400 LOC
- ‚úÖ All PRs linked to Phase-2 project
- ‚úÖ Tests and docs updated in each PR

### Long-term (first month):
- ‚úÖ PR-3 (Providers) fully implemented and tested
- ‚úÖ PR-1 (Supabase) integrated with real data
- ‚úÖ PR-5 (Auth) enforcing RLS everywhere
- ‚úÖ 80%+ of PRs auto-labeled correctly
- ‚úÖ CI/CD pipeline green consistently

---

## üêõ Common Issues

### "gh: command not found"
**Solution**: Install GitHub CLI from https://cli.github.com/

### "Permission denied: setup-phase2.sh"
**Solution**: Run `chmod +x setup-phase2.sh` first

### Workflow not triggering
**Solution**: Check PR targets `main` branch and touches files in `paths` list

### Labels not applying
**Solution**: Verify `.github/labeler.yml` patterns match your file structure

### Copilot not responding
**Solution**: Ensure Copilot is enabled for repo and PR is not draft

### Script fails on Windows
**Solution**: Use Git Bash or update line endings (`git config core.autocrlf false`)

---

## üéØ Success Indicators

Your Phase-2 setup is **fully operational** when:

‚úÖ Opening a PR automatically applies correct labels
‚úÖ CI workflow completes in < 5 minutes
‚úÖ Copilot posts code review within 2 minutes
‚úÖ Claude posts implementation plans in comments
‚úÖ Agents open stacked PRs with relevant changes
‚úÖ All PRs link to Phase-2 project
‚úÖ BEE-SHIP deployment scripts still work
‚úÖ Aurora theme remains consistent across changes

---

## üìö Further Reading

- [PHASE2_SETUP_GUIDE.md](PHASE2_SETUP_GUIDE.md) - Comprehensive setup guide
- [.github/copilot-instructions.md](.github/copilot-instructions.md) - Development patterns
- [copilot-instructions.md](copilot-instructions.md) - Code review instructions
- [COPILOT_GUARDRAILS.md](COPILOT_GUARDRAILS.md) - Agent constraints
- [BEE_SHIP_QUICK_REF.md](BEE_SHIP_QUICK_REF.md) - Deployment guide

---

## üö¢ Ready to Ship?

**Quick start**:
```bash
# Windows
setup-phase2.bat

# Unix/Linux/macOS
chmod +x setup-phase2.sh && ./setup-phase2.sh
```

Then open a PR from `feat/phase2-kickoff` to `main` and watch the magic happen! ‚ú®

---

**Generated with** [Claude Code](https://claude.com/claude-code) ü§ñ
